use test_database
go
create procedure insertIntoTables 
as
begin
	insert into Product
	(
		   [Name]
		  ,[ShortDescription]
		  ,[FullDescription]
		  ,[AdminComment]
		  ,[ProductTemplateId]
		  ,[ShowOnHomePage]
		  ,[MetaKeywords]
		  ,[MetaDescription]
		  ,[MetaTitle]
		  ,[SeName]
		  ,[AllowCustomerReviews]
		  ,[ApprovedRatingSum]
		  ,[NotApprovedRatingSum]
		  ,[ApprovedTotalReviews]
		  ,[NotApprovedTotalReviews]
		  ,[Deleted]
		  ,[CreatedOnUtc]
		  ,[UpdatedOnUtc]
		  ,[PopularityRating]
		  ,[QueryCount]
		  ,[CategoriesPath_remove]
		  ,[CategoriesNamePath_remove]
		  ,[ParentProductId]
		  ,[SKUs]
		  ,[Sku]
		  ,[Passover]
		  ,[FullNamePath_remove]
		  ,[IsEBT]
		  ,[POSDepartment]
	)

	select pb.Name, null, null, null, null, null,null,null,null,null,null, 
	null,null,null,null,null,pb.CreatedOn, null, null,null,null,null,null,null, pb.Sku, pb.[Passover],null,null,pb.[POSDepartment]
	from [test_database].[dbo].[PI_BulkItems] as pb

	insert into StoreProduct
	([StoreId]
      ,[ProductVariantId]
      ,[IsTaxExempt]
      ,[Price]
      ,[OldPrice]
      ,[SpecialPrice]
      ,[SpecialPriceStartDateTimeUtc]
      ,[SpecialPriceEndDateTimeUtc]
      ,[RegularPricePer]
      ,[SpecialPricePer]
      ,[Size]
      ,[Weight]
      ,[Unit]
      ,[Flags]
      ,[MeasureWeight]
      ,[PriceQty]
      ,[LastSold]
      ,[LimitPerOrder]
      ,[CaseStartingDate]
      ,[CaseEndingDate]
      ,[CaseQty]
      ,[CaseMaxAllowed]
      ,[CasePrice]
      ,[ShowCase]
      ,[CasePakBulk]
      ,[SpecialPakBulk]
      ,[PopularityRating]
      ,[CategoriesPath]
      ,[CategoriesNamePath]
      ,[CreatedOnUtc]
      ,[UpdatedOnUtc]
      ,[Published]
      ,[Deleted]
      ,[StockQuantity]
      ,[ProductId]
      ,[Sku]
      ,[CaseSpecialPrice]
      ,[CaseSpecialStartingDate]
      ,[CaseSpecialEndingDate]
      ,[CaseSpecialQty]
      ,[CaseSpecialMaxAllowed]
      ,[SpecialPackagePrice]
      ,[SpecialPackageStartingDate]
      ,[SpecialPackageEndingDate]
      ,[SpecialPackageQty]
      ,[SpecialPackageMaxAllowed]
      ,[StoreWeight]
      ,[Life]
      ,[StorePublish]
      ,[LocOnly]
      ,[Shelf]
      ,[StockStatusId]
      ,[StockStatusReportedByCustomerId]
      ,[StockStatusUpdatedOnUtc]
      ,[StockStatusReportedOnOrderId]
      ,[SoldByCount]
      ,[VendorId]
      ,[LayoutLocationId]
      ,[OrderMaximumQuantity]
      ,[OldGenericProductId]
      ,[MakeStoreSpecificOnUtc]
      ,[RetailPrice]
      ,[TaxCategoryId]
      ,[PublishMode]
      ,[PublishModeBy]
      ,[PublishModeUtc]
      ,[FullNamePath]
      ,[Department]
      ,[DepartmentId]
      ,[PackageDepositUnitPrice])

	  select  pb.StoreId,null,'',pb.SalePrice,pb.CasePrice,
	  pb.SpecialPrice,pb.SpecialStarts,pb.SpecialEnds,null, pb.SpecialPricePer,pb.Size,pb.ByWeight,pb.Unit, pb.Flags, null, null,
	  pb.LastSold, null, pb.CaseStartingDate,pb.CaseEndingDate,pb.CaseQty,pb.CaseMaxAllowed, pb.CasePrice, null, pb.CasePakBulk, null, null,
	  null,null, pb.CreatedOn,null,null,null,null, pb.ItemId, pb.Sku, null,null, null,null,null,null, null, null,null,null, pb.StoreWeight, 
	  pb.Life, pb.StorePublish, null, pb.Shelf, null,null,null, null, null,  null, null,null,null,null, pb.RetailPrice, pb.TaxCategory, 
	  null,null,null, null, null,null, pb.PackageDepositUnitPrice
	  from [test_database].[dbo].[PI_BulkItems] as pb

	insert into ProductVariant 
	(
	[ProductId]
      ,[Name]
      ,[Sku]
      ,[Description]
      ,[AdminComment]
      ,[ManufacturerPartNumber]
      ,[Gtin]
      ,[IsGiftCard]
      ,[GiftCardTypeId]
      ,[RequireOtherProducts]
      ,[RequiredProductVariantIds]
      ,[AutomaticallyAddRequiredProductVariants]
      ,[IsDownload]
      ,[DownloadId]
      ,[UnlimitedDownloads]
      ,[MaxNumberOfDownloads]
      ,[DownloadExpirationDays]
      ,[DownloadActivationTypeId]
      ,[HasSampleDownload]
      ,[SampleDownloadId]
      ,[HasUserAgreement]
      ,[UserAgreementText]
      ,[IsRecurring]
      ,[RecurringCycleLength]
      ,[RecurringCyclePeriodId]
      ,[RecurringTotalCycles]
      ,[IsShipEnabled]
      ,[IsFreeShipping]
      ,[AdditionalShippingCharge]
      ,[IsTaxExempt]
      ,[TaxCategoryId]
      ,[ManageInventoryMethodId]
      ,[StockQuantity]
      ,[DisplayStockAvailability]
      ,[DisplayStockQuantity]
      ,[MinStockQuantity]
      ,[LowStockActivityId]
      ,[NotifyAdminForQuantityBelow]
      ,[BackorderModeId]
      ,[AllowBackInStockSubscriptions]
      ,[OrderMinimumQuantity]
      ,[OrderMaximumQuantity]
      ,[AllowedQuantities]
      ,[DisableBuyButton]
      ,[DisableWishlistButton]
      ,[AvailableForPreOrder]
      ,[CallForPrice]
      ,[Price]
      ,[OldPrice]
      ,[ProductCost]
      ,[SpecialPrice]
      ,[SpecialPriceStartDateTimeUtc]
      ,[SpecialPriceEndDateTimeUtc]
      ,[CustomerEntersPrice]
      ,[MinimumCustomerEnteredPrice]
      ,[MaximumCustomerEnteredPrice]
      ,[HasTierPrices]
      ,[HasDiscountsApplied]
      ,[Weight]
      ,[Length]
      ,[Width]
      ,[Height]
      ,[PictureId]
      ,[AvailableStartDateTimeUtc]
      ,[AvailableEndDateTimeUtc]
      ,[Deleted]
      ,[DisplayOrder]
      ,[CreatedOnUtc]
      ,[UpdatedOnUtc]
      ,[RegularPricePer]
      ,[SpecialPricePer]
      ,[Size]
      ,[Unit]
      ,[Flags]
      ,[MeasureWeight]
      ,[PriceQty]
      ,[LastSold]
      ,[LimitPerOrder]
      ,[CaseStartingDate]
      ,[CaseEndingDate]
      ,[CaseQty]
      ,[CaseMaxAllowed]
      ,[CasePrice]
      ,[ShowCase]
      ,[CasePakBulk]
      ,[SpecialPakBulk]
	)
	select pb.ItemId,pb.Name, pb.Sku,null,null, null, null, null,null, null, null, null, null, null, null, null,
	null,null,null, null, null, null,null,null,null,null,null,null,null,null, null, null, null,null, null,
	null,null,null, null,null,null,null,null,null,null,null,null, pb.RetailPrice, pb.CasePrice,null, pb.SpecialPrice,
	pb.SpecialStarts, pb.SpecialEnds, null, null,null, null, null, pb.ByWeight, null,null,null, null, null,null,null,null,pb.CreatedOn,
	null, null, pb.SpecialPricePer, pb.Size,pb.Unit,pb.Flags, pb.Measure, null, pb.LastSold,null,pb.CaseStartingDate,
	pb.CaseEndingDate, pb.CaseQty, pb.CaseMaxAllowed, pb.CasePrice, null, pb.CasePakBulk, pb.SpecialPakBulk 
	from [test_database].[dbo].[PI_BulkItems] as pb
end;

